<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: game.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: game.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// game.js

/**
 * Gestisce la logica del gioco Snake (stato, movimento, collisioni)
 */
export class SnakeGame {
    /**
     * @param {Object} config - Configurazione opzionale
     * @param {number} [config.dimensioneGriglia=20] - Lato della griglia
     * @param {number} [config.velocitaIniziale=150] - Delay tra gli update (ms)
     */
    constructor(config = {}) {
        this.dimensioneGriglia = config.dimensioneGriglia || 20;
        this.velocitaIniziale = config.velocitaIniziale || 150;
        this.reset();
    }

    /** Reimposta lo stato del gioco */
    reset() {
        const centro = Math.floor(this.dimensioneGriglia / 2);

        /** Corpo del serpente (testa = indice 0) */
        this.serpente = [{ x: centro, y: centro }];

        /** Direzione attuale di movimento */
        this.direzione = { x: 0, y: 0 };

        this.punteggio = 0;
        this.velocita = this.velocitaIniziale;
        this.inCorso = false;

        this.posizionaCibo();
    }

    /**
     * Imposta una nuova direzione se non è l'opposto di quella attuale.
     * @param {{x: number, y: number}} dir - Direzione richiesta
     */
    impostaDirezione(dir) {
        if (!dir) return;

        // Impedisce di invertire la direzione
        if (this.direzione.x !== 0 &amp;&amp; dir.x === -this.direzione.x) return;
        if (this.direzione.y !== 0 &amp;&amp; dir.y === -this.direzione.y) return;

        this.direzione = dir;

        // Avvia il gioco al primo movimento
        if (dir.x !== 0 || dir.y !== 0) this.inCorso = true;
    }

    /**
     * Genera una posizione casuale per il cibo, evitando il serpente.
     * @returns {{x: number, y: number}} posizione del cibo
     */
    posizionaCibo() {
        let pos;
        do {
            pos = {
                x: Math.floor(Math.random() * this.dimensioneGriglia),
                y: Math.floor(Math.random() * this.dimensioneGriglia),
            };
        } while (this.serpente.some(s => s.x === pos.x &amp;&amp; s.y === pos.y));

        this.cibo = pos;
        return pos;
    }

    /**
     * Aggiorna lo stato del gioco: muove il serpente, controlla collisioni.
     * @returns {{morto: boolean, mangiato: boolean}}
     */
    aggiorna() {
        if (!this.inCorso) return { morto: false, mangiato: false };

        const testa = {
            x: this.serpente[0].x + this.direzione.x,
            y: this.serpente[0].y + this.direzione.y
        };

        // Collisione con muri o corpo
        const collisione =
            testa.x &lt; 0 ||
            testa.x >= this.dimensioneGriglia ||
            testa.y &lt; 0 ||
            testa.y >= this.dimensioneGriglia ||
            this.serpente.some(s => s.x === testa.x &amp;&amp; s.y === testa.y);

        if (collisione) {
            this.inCorso = false;
            return { morto: true, mangiato: false };
        }

        // Avanza
        this.serpente.unshift(testa);

        // Controlla se ha mangiato
        if (testa.x === this.cibo.x &amp;&amp; testa.y === this.cibo.y) {
            this.punteggio++;
            this.posizionaCibo();
            return { morto: false, mangiato: true };
        }

        // Muove eliminando la coda
        this.serpente.pop();
        return { morto: false, mangiato: false };
    }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="SnakeGame.html">SnakeGame</a></li></ul><h3>Global</h3><ul><li><a href="global.html#avviaTimer">avviaTimer</a></li><li><a href="global.html#bufferDirezione">bufferDirezione</a></li><li><a href="global.html#disegna">disegna</a></li><li><a href="global.html#disegnaCella">disegnaCella</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Tue Dec 09 2025 18:49:52 GMT+0100 (Ora standard dell’Europa centrale)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
